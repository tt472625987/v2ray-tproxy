# v2ray-tproxy 全局配置（被 /etc/firewall.v2ray 引用）
# 说明：FW_MARK 优先；若未设置则回退使用 MARK_VALUE（兼容旧配置）

# 必需参数
TPROXY_PORT=12345          # 透明代理程序监听的端口（本机）
FW_MARK=0x1                # fwmark 标记值（建议与策略路由配套唯一）
MARK_VALUE=0x1             # 兼容字段（建议与 FW_MARK 保持一致或移除）
ROUTE_TABLE=100            # 自定义策略路由表编号（100-252 之间，避免冲突）

# 协议开关（可选）
ENABLE_UDP=1               # 1=启用 UDP TPROXY（确保程序已监听 UDP）
ENABLE_IPV6=1             # 1=启用 IPv6 规则（需要 ip6tables）

# ipset 集合名称配置（与 chinadns-ng 保持一致）
CHN_IPSET4="chnip"         # 国内 IPv4 IP 集合名称
CHN_IPSET6="chnip6"        # 国内 IPv6 IP 集合名称
GFW_IPSET4="gfwip"         # GFW IPv4 IP 集合名称（可选）
GFW_IPSET6="gfwip6"        # GFW IPv6 IP 集合名称（可选）

# 排除网段（可选）
LOCAL_SUBNET="192.168.31.0/24"           # 例如：192.168.31.0/24；为空则不额外排除
LOCAL_SUBNET6=""          # 例如：fd00::/8；为空则不额外排除

# UDP端口排除（当ENABLE_UDP=1时生效）
# 这些端口如果被代理会导致网络问题
# 格式：端口1,端口2,端口3（用逗号分隔）
UDP_EXCLUDE_PORTS="53,67,68,69,111,123,137,138,139,161,162,514,520,1194,1900,2049,500,4500,21115,21116,21117,21118,21119"    # 关键网络服务端口 + RustDesk

# UDP端口排除说明：
# 53: DNS服务 - 域名解析
# 67,68: DHCP服务 - 动态IP分配
# 69: TFTP - 文件传输
# 111: RPC - 远程过程调用
# 123: NTP - 网络时间同步
# 137,138,139: NetBIOS - Windows网络服务
# 161,162: SNMP - 网络管理
# 514: Syslog - 系统日志
# 520: RIP - 路由信息协议
# 1194: OpenVPN - VPN服务
# 1900: SSDP - 设备发现
# 2049: NFS - 网络文件系统
# 500,4500: IPSec - VPN隧道
# 21115-21119: RustDesk - 远程桌面TCP/UDP通信

# 日志（可选）
# 留空表示关闭；开启后会以限速方式记录（10/min），避免刷屏
LOG_PREFIX="V2RAY-TPROXY"             # 例如：[V2RAY-TPROXY] 