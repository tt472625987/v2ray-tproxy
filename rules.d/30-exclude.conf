#!/bin/sh
. /home/v2ray-tproxy/config.conf

# 传统shell写法（兼容性更好）
for subnet in 0.0.0.0/8 10.0.0.0/8 127.0.0.0/8 \
              169.254.0.0/16 172.16.0.0/12 \
              224.0.0.0/4 240.0.0.0/4; do
    iptables -t mangle -I PREROUTING 2 -d "$subnet" -j RETURN
done

# 动态添加LOCAL_SUBNET（如果存在且不是空值）
[ -n "$LOCAL_SUBNET" ] && \
    iptables -t mangle -I PREROUTING 2 -d "$LOCAL_SUBNET" -j RETURN